#!/usr/bin/env ansible-playbook
---
- name: Spencer's configuration
  hosts:
    - wafflemaker.local
  user: sbrow
  vars:
    commands:
      - ansible
      - ansible-lint
      - parallel
      - watch
      - zplug
    applications:
      - cleanmymac # provider=appdmg source = 'https://dl.devmate.com/com.macpaw.CleanMyMac4/CleanMyMacX.dmg'
      - discord
      - firefox
      - flux
      - joplin
      - lastpass
      - skype
      - steam
      - teamviewer
      - virtualbox
      - visual-studio-code
  tasks:
    - name: Create user
      user:
        name: sbrow
        comment: Spencer Brower
        shell: /bin/zsh
        # group: 20
    - name: Configure ~/.zshrc
      copy:
        src: ./files/.zshrc
        dest: ~/.zshrc
        force: no
    - name: Install Commands
      package:
        name: "{{ commands }}"
        state: latest
    - name: Install Applications
      package:
        name: "{{ applications }}"
        state: latest
        use: homebrew_cask
- name: Setup GPG Suite
  hosts:
    - wafflemaker.local
  tasks:
    - name: Install GPG Suite
      package:
        name: gpg-suite
        state: latest
        use: homebrew_cask
    - name: Configure GPG Suite
      copy:
        content: |
          pinentry-program /usr/local/MacGPG2/libexec/pinentry-mac.app/Contents/MacOS/pinentry-mac
          enable-ssh-support
          default-cache-ttl 600
          max-cache-ttl 7200
        dest: ~/.gnupg/gpg-agent.conf
        force: yes
